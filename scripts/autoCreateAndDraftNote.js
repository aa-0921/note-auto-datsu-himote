// autoCreateAndDraftNote.js
// 薄いラッパー：既存のCLI引数・動作は維持しつつ、実装は共有ライブラリに委譲

import { runWithCore } from '@aa-0921/note-auto-core';

(async () => {
  await runWithCore(async ({ core, wantsBackground }) => {
    // アカウント固有の題材・切り口（非モテ男子の恋愛研究所）
    const topics = [
      'マッチングアプリ攻略',
      // '街コン攻略',
      'デートの誘い方',
      'LINE等のメッセージの返信術',
      'プロフィール写真の撮り方',
      '初回デートの場所選び',
      '会話が続かない問題',
      '自信のない男の改善法',
      '女性心理の読み方',
      '脈ありサインの見抜き方',
      'フレンドゾーン脱出法',
      '告白のタイミング',
      'アプローチの仕方',
      '服装・ファッション',
      '髪型・身だしなみ',
      '話し方・声のトーン',
      '姿勢・仕草の改善',
      '自己肯定感の高め方',
      '恋愛コンプレックスの克服',
      'モテる男の特徴',
      '非モテから脱却する方法',
      // '出会いの場の作り方',
      // 'サークル・趣味での出会い',
      '職場恋愛のコツ',
      '年上女性との恋愛',
      '年下女性との恋愛',
      '同年代女性との恋愛',
      '恋愛での失敗パターン',
      // '失恋からの立ち直り方',
      '恋愛での成長方法',
    ];

    const patterns = [
      '【2025年最新版】完全攻略法',
      '【無意識にやってる？】NG行動',
      '【年収で負けても勝てる】裏技',
      '【ただの友達で終わらない】発展術',
      '【返信率UP】最強テンプレ術',
      '【課金する前に絶対読んで】基本戦略',
      '【もう勘違いしない】見抜き方',
      '【24時間以内にデート確定】即誘い術',
      '【人生逆転】ギャップ演出術',
      '【9割の男が知らない】戦略',
      '【彼女を作る】成功率を上げる方法',
      '【いいね0の男性必見】改善法',
      '【with攻略2025年版】活用術',
      // '【東カレデート】出会いの裏技',
      '【趣味サークル】恋愛発展の秘訣',
      '【マッチングアプリ】会話継続術',
      '【cocome】無料でマッチング増加法',
      '【脈ありサイン】レベル別解説',
      // '【婚活プロフィール写真】選び方',
      '【ライバル不在】狙うべき女性タイプ',
      '【非モテ男子でも彼女ができる】方法',
      '【女性が瞬時に見抜く】オーラ改善法',
      '【ハイスペじゃない男が美女と出会う】裏技',
      '【自然なアプローチ】彼女を作る方法',
      '【初回メッセージ】最強テンプレ術',
      '【初回メッセージ】最強テンプレ術',
      // '【有料プランが逆効果】基本戦略',
      '【社交辞令との違い】見抜き方',
      // '【プロに頼むべきか】選び方',
      '【本当に狙うべき】女性のタイプ',
      // '【準備からアフターフォローまで】徹底解説',
    ];

    const rewriteConditionsLines = [
      'あなたは元非モテ男子の恋愛アドバイザーです。',
      '指定の見出し本文が短いため、300文字以上になるよう実体験や具体例、アドバイスを交えて厚くリライトしてください。',
      '【注意】',
      '- タイトルや見出しは出力せず、本文のみを返す。',
      '- メタ情報（追加要素や文字数など）は一切出力しない。',
      '- 丁寧な敬語（です・ます）で、読みやすさ重視。',
      '- 絵文字は使わない。',
      '- 元の内容に沿い、noteのMarkdownのみ使用。',
      '- 箇条書きは「・ 」、番号付きリストは使わない。',
      '- 元非モテ男子として、同じ悩みを持つ男性に寄り添い、具体的で実践的なアドバイスを提供する。',
      '- 「〇〇の〇〇です」という名乗りは避ける。',
    ];

    // LLM用システムプロンプト（非モテ男子の恋愛研究所）
    const systemMessage = 'あなたは元非モテ男子で、心理学・行動科学の研究に基づいた科学的な根拠を持つ恋愛アドバイザーです。同じ悩みを持つ男性に寄り添い、科学的に立証された実践的なアドバイスを提供します。';

    // 記事生成プロンプト条件（非モテ男子の恋愛研究所）
    const articleConditionsLines = [
      'タイトル、本文、ハッシュタグ（#から始まるもの）を含めてください。',
      'タイトルは1行目に「# [実際のタイトル]」として記載してください。',
      '「# タイトル」という文字列ではなく、実際の記事タイトルを入れてください。',
      '本文にはタイトルを含めないでください。',
      '本文は見出しや箇条書きも交えて1000文字程度で丁寧にまとめてください。',
      'ハッシュタグは記事末尾に「#〇〇 #〇〇 ...」の形式でまとめてください。',
      'あなたは元非モテ男子で、プロの編集者です。',
      '読みやすさを重視してください。',
      '改行を多めに入れてください。',
      '絵文字は使わないでください。',
      'すべて日本語で出力してください。',
      // '切り口に沿った内容にしてください。',
      'noteの正しいマークダウン記法のみを使ってください。',
      '箇条書きはマークダウンではなく、「・ 」で表現してください。',
      '見出しはh2（## 見出し）・h3（### 見出し）のみ。',
      '見出しに「**」等は使わないでください。',
      '番号付きリストは使わないでください。',
      'h1（# タイトル）はタイトル行のみで本文中では使わないでください。',
      'その他のマークダウンやHTMLタグは使わないでください。',
      '元非モテ男子として、同じ悩みを持つ男性に共感し、具体的で実践的な解決策を提供してください。',
      '恋愛でうまくいかない男性の現状を理解し、希望を与える内容にしてください。',
      '「〇〇の〇〇です」という名乗りは避けてください。',
      '・タイトルや本文に「無料」「有料」という言葉は絶対に使用しないでください。',
      '・【重要】必ず5つの項目を提示し、有料部分も5つの章で構成すること（4つや6つは禁止）',
      '',
      '【記事の構成と流れ】',
      '以下の構成に従って記事を作成してください：',
      '',
      '1. タイトル：',
      '・年号を入れる場合は必ず「2025年」を使用し、「2024年」は使わない',
      '・年号は必須ではなく、必要に応じて使用する',
      // '・【年号/数字】+ キーワード + 具体的な方法 + ｜ + 詳細説明の構成',
      '・感情に訴える表現（「劇的に」「急に」「瞬時に」など）',
      '・数字の効果的な使用（年号、割合、時間制限など）',
      '・タイトルに「無料」「有料」という言葉は絶対に使用しない',
      '',
      '2. 導入部分：',
      '・現状の問題提起：読者の悩みに共感する現状描写',
      '・共感の誘発：「〜したことはありませんか？」という問いかけ',
      '・科学的根拠の提示：心理学・行動科学の研究データや統計を引用',
      // '・大学や研究機関の名前を具体的に記載（例：スタンフォード大学、ハーバード大学、ケンブリッジ大学など）',
      // '・研究結果の数値データを含める（例：返信率67%向上、成功率98%など）',
      '・解決策の提示：問題の正体を明示し、科学的な解決の可能性を示す',
      '・本文に「無料」「有料」という言葉は絶対に使用しない',
      // '・記事の価値明示：「この記事を読むことで、あなたは以下の6つを得られます」',
      '',
      '3. 無料部分の充実化：',
      '・無料部分では具体的なヒントや解決策は提供しない',
      '・現状できていないことでの問題点やリスク、デメリットを強調',
      '・「このまま彼女ができないよりは読んだほうが絶対にいいです」という緊迫感を演出',
      '・読者の不安や焦りを煽り、有料部分を買ってでも読みたくなるようにする',
      '・有料部分で得られる「完全版」の価値をアピールし、期待感を高める',
      // '',
      // '4. 価値提示部分：',
      // '・記事の価値明示：「この記事を読むことで、あなたは以下の6つを得られます」',
      // '・読者が得られる具体的なメリットを6つのポイントで提示',
      // '・各ポイントは①、②、③、④、⑤、⑥の記号で整理',
      // '・実践的で具体的な内容を約束',
      // '・この6つのポイントは「有料項目紹介セクション」として機能',
      // '・有料部分では、この6つのタイトルをそのまま使用すること',
      '',
      '4. 無料部分の追加コンテンツ：',
      '・5つの価値提示の後に、問題点やリスクの詳細説明を追加',
      '・各ポイントについて、現状のままだとどうなるかのデメリットを強調',
      '・「このまま彼女ができないよりは読んだほうが絶対にいいです」という緊迫感を強調',
      '・有料部分で得られる価値をアピール',
      '・読者の現状への不安を煽り、行動を促す',
      '・具体的な解決策は一切提供せず、問題の深刻さのみを伝える',
      '',
      '5. 有料項目紹介セクション（必須）：',
      '・【重要】必ず「この記事を読むことで、あなたは以下の5つを知ることができます。」の文言を使用',
      '・【重要】必ず①、②、③、④、⑤の5つの記号で5つの価値を提示（4つや6つは禁止）',
      '・【重要】5つの項目は必ず存在し、有料部分の5つの章と完全に一致すること',
      '・各ポイントは簡潔で魅力的なタイトルにする',
      '・読者の期待感を最大限に高める',
      '・「このまま彼女ができないよりは読んだほうが絶対にいいです」という緊迫感を強調',
      '・有料部分で得られる価値をアピール',
      '・読者の現状への不安を煽り、行動を促す',
      '・具体的な解決策は一切提供せず、問題の深刻さのみを伝える',
      '',
      '6. 有料部分メッセージ：',
      '・「有料項目紹介セクション」の直後に「ここからは有料になります」と明記',
      // '・「このまま彼女ができないよりは読んだほうが絶対にいいです」というメッセージを強調',
      // '・無料部分で十分な価値を提供し、有料部分への期待を高める',
      '',
      '7. 有料部分の構成（必須）：',
      '・【重要】必ず5つのセクションを作成（4つや6つは禁止）',
      '・【重要】各セクション300文字以上で具体的な方法を解説',
      '・【重要】無料部分で約束した5つの価値と有料部分の内容が完全に一致すること',
      '・【重要】無料部分で「この記事を読むことで、あなたは以下の5つを知ることができます」で提示した内容を、有料部分でそのまま提供すること',
      '・【重要】有料部分のタイトルは、無料部分の「有料項目紹介セクション」で提示した5つのタイトルをそのまま使用すること',
      '・【重要】有料部分の各セクションのタイトルは「## タイトル」の形式で記述すること',
      '・【重要】各セクションに科学的根拠を必ず含めること：',
      '  - 心理学の法則や理論（例：互恵性の法則、ツァイガルニク効果、社会的承認の原理など）',
      '  - 行動科学の研究結果（例：脳科学、神経科学の知見）',
      // '  - 具体的な研究機関名と数値データ',
      '  - 科学的なメカニズムの説明',
      '・実践的で即効性のある内容',
      '・各セクションには以下の要素を必ず含めること：',
      '  - 科学的根拠の説明（**科学的根拠：○○効果**の形式で見出しを作成）',
      '  - 実体験やエピソード',
      '  - よくある失敗例とその対処法',
      '  - 今日からできる具体的なアクション',
      '  - 注意点やNG行動',
      '  - より効果を高めるコツ',
      '  - 読者が「なるほど！」と思える気づき',
      '',
      '【重要】無料部分と有料部分の内容一致（必須遵守）：',
      '・【重要】無料部分で約束した5つのポイントのタイトルと内容を、有料部分でそのまま使用すること',
      '・【重要】無料部分の「有料項目紹介セクション」で提示した5つのタイトルを、有料部分の見出しとしてそのまま使用すること',
      '・【重要】例：「第一印象を圧倒的に良くする具体的な方法」と約束したら、有料部分でも同じタイトルで内容を提供すること',
      '・【重要】約束した内容と実際に提供する内容に不整合があってはいけません',
      '・【重要】5つの項目が不足している記事は絶対に作成しないこと',
      '',
      '【記事の終わり方】',
      '・記事の最後は以下の文言で終わること：',
      '「最後までお読みいただきありがとうございます！🙇継続して非モテを脱出する情報を発信していきますので、どうかフォローお願いします！🙏」',
      // '',
      // '【科学的根拠の組み込み方】',
      // '・各セクションで使用する心理学・行動科学の法則：',
      // '  - 互恵性の法則（返報性の原理）',
      // '  - ツァイガルニク効果（未完結効果）',
      // '  - 社会的承認の原理',
      // '  - ハロー効果（第一印象効果）',
      // '  - アンカリング効果',
      // '  - バンドワゴン効果',
      // '  - 希少性の原理',
      // '  - 一貫性の原理',
      // '  - 権威性の原理',
      // '  - 好意の返報性',
      // '・研究機関の例：',
      // '  - スタンフォード大学',
      // '  - ハーバード大学',
      // '  - ケンブリッジ大学',
      // '  - マサチューセッツ工科大学（MIT）',
      // '  - カリフォルニア大学',
      // '  - オックスフォード大学',
      // '  - 東京大学',
      // '  - 京都大学',
      // '・数値データの例：',
      // '  - 返信率67%向上',
      // '  - 成功率98%',
      // '  - 第一印象の93%が3秒で決まる',
      // '  - 内面を褒めることで返信率38%向上',
      // '  - 外見を褒めることで返信率24%低下',
      // '・科学的根拠の説明形式：',
      // '  - 「**科学的根拠：○○効果**」の見出しを作成',
      // '  - 研究機関名と研究者名を記載',
      // '  - 具体的な数値データを含める',
      // '  - 科学的なメカニズムを簡潔に説明',
      // '  - 実践への応用方法を明示',
    ];

    // タグ生成の指示文（非モテ男子の恋愛研究所）
    const tagsInstruction =
      '記事内容から最も関連する日本語タグを3〜5個生成し、半角スペース区切りで出力してください。必ず「#非モテ #恋愛 #彼女 #マッチングアプリ #攻略 #心理学 #科学的根拠」を含めてください。本文や説明は禁止。';

    // タイトル装飾用絵文字（非モテ男子の恋愛研究所）
    const titleEmojis = [
      '💕',
      '💘',
      '😍',
      '💪',
      '🔥',
      '✨',
      '💎',
      '🎯',
      '🚀',
      '💯',
      '👑',
      '💖',
    ];

    // ----------------------------------------------------------------------------------
    // 記事内に挿入するアフィリエイト文（参考実装の体裁を反映）
    // const affiliateLink = [
    //   '',
    //   '💰　💎　💰　💎　💰　💎　💰　💎　💰　💎　💰　💎　💰　💎　💰',
    //   'https://amzn.to/4goaSUk',
    //   '👆引き寄せの法則がわかるおすすめの本です😊コスパ最強です👍',
    //   '💰　💎　💰　💎　💰　💎　💰　💎　💰　💎　💰　💎　💰　💎　💰',
    //   '',
    // ].join('\n');

    // ----------------------------------------------------------------------------------
    const affiliateLinks = [];

    // ----------------------------------------------------------------------------------


    // マガジン誘導文（空配列）
    const magazinePromotion = [];

    // アソシエイト表記文（空文字）
    const amazonAssociateText = '';

    // 記事の自動生成と下書き保存機能を実行
    await core.runAutoCreateAndDraftNote({
      background: wantsBackground,
      topics,
      patterns,
      systemMessage,
      articleConditionsLines,
      rewriteConditionsLines,
      tagsInstruction,
      titleEmojis,
      // affiliateLink,
      affiliateLinks,
      magazinePromotion,
      amazonAssociateText,
    });
    console.log('記事の自動生成と下書き保存が完了しました');
  });
})();
